/*--------------------------------*- C++ -*----------------------------------*\
| =========                 |                                                 |
| \\      /  F ield         | OpenFOAM: The Open Source CFD Toolbox           |
|  \\    /   O peration     | Version:  2.2.2                                 |
|   \\  /    A nd           | Web:      www.OpenFOAM.org                      |
|    \\/     M anipulation  |                                                 |
\*---------------------------------------------------------------------------*/
FoamFile
{
    version     2.0;
    format      ascii;
    class       dictionary;
    location    "constant";
    object      thermophysicalProperties;
}
// * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * //

homogeneousReactions on;	// chemistry on/off
minT  280.;			// minimum temperature in K (useful for steady-state)
maxT 3500.;			// maximum temperature in K (useful for steady-state)

combustionModel "EDC";

ED
{
	A	4.;
	B	0.5;
}

EDFR
{
	A	4.;
	B	0.5;
}

EDC
{
	reactorType				"PSR";			// Reactor type: PSR || PFR
	Ccsi 					2.1377;			// EDC parameter
	Ctau 					0.40825;		// EDC parameter
	maxGammaSquared 			0.75487766248;		// EDC parameter
	numberOfResidenceTimes			100.;			// ODE total integration time
	numberIterationsToUpdateChemistry	1;			// number of CFD iteration to solve the ODE system
}

Ode
{
	odeSolver				"OpenSMOKE";		// Ode Solver
	relTolerance				1e-7;			// ODE relative tolerance
	absTolerance				1e-12;			// ODE absolute tolerance
	fullPivoting				false;			// full pivoting during LU factorization
	maximumOrder				5;			// maximum order of ODE integration (only for OpenSMOKE++ solver)
}

Spark
{
	spark           	on;
	position        	(5e-3  0 5.e-3);
	time            	0;
	temperature     	2500;
	duration        	50;
	diameter        	10e-3;
	additionalMassFraction	1e-3;
}

ISAT 
{
	// Basic parameters
 	ISAT		 			off;		// ISAT on/off
	tolerance 				1e-5;		// ISAT tolerance [default: 1e-4]
	numberSubSteps				1;		// ISAT number of substeps for calculating gradient mapping [default: 1]

	// Lists of useful leaves
	searchMRU				on;		// search for MRU (Most Recently Used) leaves [default: on]
	searchMFU				on;		// search for MFU (Most Frequently Used) leaves [default: on]
	maxSizeMRU 				100;		// max size of MRU (Most Recently Used) [default: 100]
	maxSizeMFU 				100; 		// max size of MFU (Most Frequently Used) [default: 100]
	maxSearchMRU 				10;		// max numbers of leaves to be tested (MRU) [default: 10]
	maxSearchMFU 				30;		// max numbers of leaves to be tested (MFU) [default: 30]

	// What to do when the tre is full?
	maxSizeBT 				100000;		// max size of binary tree [default: 100000]
	clearingIfFull 				off;             // if on the tree is cleared when full [default: off]
		
	// Balancing coefficients
	maxTimeOldCoeff 			0.7;		// ? [default: 0.7]
	maxGrowCoeff 				0.5;		// ? [default: 0.5]
	maxUsedCoeff 				20.;		// ? [default: 20.]
	maxHeightCoeff 				20.;		// ? [default: 20.]
	
	// Output data
	statistics				on;		// print statistics on file (useful for parallel calculations) [default: off]

	// Factorizations
	luFactorization				"Partial";	// LU factorization of dense matrices (Partial || Full) [default: Partial]
	qrFactorization				"Full";		// QR factorization of dense matrices (NoPivoting || Partial || Full) [default: Full]

	// Scaling factors
	scalingFactors
	{
		T 	1.e+4;
		tf	1.e-5;
		others 	1.;		
	}

	// Absoute weights to scale the errors
	scalingErrors
	{
		T 	1.;
		tf	1.;
		others	1.;		
	}
}

// * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * //
